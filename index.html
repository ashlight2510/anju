<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ì§€ê¸ˆ ì´ ìˆ ì— ğŸ»</title>

  <!-- SEO / OG -->
  <meta name="description" content="ì§€ê¸ˆ ì´ ìˆ ì— ë”± ë§ëŠ” ì•ˆì£¼ í•˜ë‚˜, ê³ ë¯¼ ì—†ì´ ë°”ë¡œ ì¶”ì²œ" />
  <meta property="og:title" content="ì§€ê¸ˆ ì´ ìˆ ì— ğŸ»" />
  <meta property="og:description" content="ìˆ  ì¢…ë¥˜ì™€ ë°°ê³ í””ë§Œ ê³ ë¥´ë©´ ëë‚˜ëŠ” ì•ˆì£¼ ì¶”ì²œ ì„œë¹„ìŠ¤" />
  <meta property="og:image" content="https://dummyimage.com/1200x630/020617/ffffff&text=ANJU" />
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64'%3E%3Ctext y='50%25' x='50%25' dy='.35em' font-size='52' text-anchor='middle'%3E%F0%9F%8D%BB%3C/text%3E%3C/svg%3E" />

  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, sans-serif;
      background: #0f172a;
      color: #fff;
    }

    header {
      padding: 28px 16px;
      text-align: center;
      background: #020617;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    header h1 {
      margin: 0;
      font-size: 30px;
    }

    header p {
      margin-top: 8px;
      font-size: 14px;
      color: #94a3b8;
    }

    main {
      max-width: 720px;
      margin: 0 auto;
      padding: 24px 16px 40px;
    }

    .card {
      background: #020617;
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 20px;
      padding: 20px;
    }

    .step-title {
      font-size: 20px;
      font-weight: 700;
    }

    .step-sub {
      font-size: 13px;
      color: #94a3b8;
      margin-top: 4px;
    }

    .choices {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-top: 20px;
    }

    .choice {
      background: #0f172a;
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 16px;
      padding: 16px 10px;
      text-align: center;
      cursor: pointer;
      transition: 0.2s;
    }

    .choice:hover {
      background: #1e293b;
      transform: translateY(-2px);
    }

    .result {
      margin-top: 20px;
    }

    .badge {
      display: inline-block;
      background: #1e293b;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 12px;
      margin-right: 6px;
      margin-top: 6px;
    }

    .actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 18px;
    }

    .btn {
      flex: 1;
      min-width: 160px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.1);
      background: #1e293b;
      color: #fff;
      cursor: pointer;
      font-size: 14px;
      transition: 0.2s;
    }

    .btn:hover {
      background: #2b384e;
    }

    footer {
      margin-top: 40px;
      text-align: center;
      font-size: 12px;
      color: #64748b;
    }
  </style>
</head>

<body>
<header>
  <h1>ğŸ» ì§€ê¸ˆ ì´ ìˆ ì—</h1>
  <p>ì§€ê¸ˆ ì´ ìˆ ì—, ë”± ë§ëŠ” ì•ˆì£¼ í•˜ë‚˜</p>
</header>

<main>
  <div class="card" id="stepCard"></div>
  <div class="card result" id="resultCard" style="display:none;"></div>

  <footer>
    Â© ì§‘ìˆ  ë©”ì´íŠ¸ Â· ì•ˆì£¼ ì¶”ì²œ ì„œë¹„ìŠ¤
  </footer>
</main>

<script>
/* STEP ì •ì˜ */
const steps = [
  {
    key: "drink",
    q: "ì–´ë–¤ ìˆ ì´ì•¼?",
    sub: "ìˆ ì— ë”°ë¼ ì•ˆì£¼ê°€ ì™„ì „íˆ ë‹¬ë¼ì ¸ìš”.",
    a: [
      { t: "ğŸº ë§¥ì£¼", v: "beer" },
      { t: "ğŸ¶ ì†Œì£¼", v: "soju" },
      { t: "ğŸ· ì™€ì¸", v: "wine" },
      { t: "ğŸ¥ƒ ìœ„ìŠ¤í‚¤", v: "whiskey" }
    ]
  },
  {
    key: "wineType",
    q: "ì™€ì¸ ì¢…ë¥˜ëŠ”?",
    sub: "ë ˆë“œì™€ í™”ì´íŠ¸ëŠ” ì–´ìš¸ë¦¬ëŠ” ì•ˆì£¼ê°€ ë‹¬ë¼ìš”.",
    condition: (a) => a.drink === "wine",
    a: [
      { t: "ğŸ· ë ˆë“œì™€ì¸", v: "red" },
      { t: "ğŸ¥‚ í™”ì´íŠ¸ì™€ì¸", v: "white" }
    ]
  }
];

/* ì•ˆì£¼ ë ˆì‹œí”¼ */
const recipes = [
  // ğŸ¶ ì†Œì£¼
  {
    name: "ë‘ë¶€ê¹€ì¹˜",
    drink: ["soju","beer"],
    hunger: "mid",
    alcoholFit: "ì†Œì£¼ë‘ ì°°ë–¡",
    time: 15,
    difficulty: "í•˜",
    description: "ê¸°ë¦„ê¸°ì™€ ì‚°ë¯¸ ì¡°í•©ìœ¼ë¡œ ì†Œì£¼ê°€ ìˆ ìˆ  ë“¤ì–´ê°€ëŠ” êµ­ë£° ì•ˆì£¼"
  },
  {
    name: "ì‚¼ê²¹ì‚´",
    drink: ["soju"],
    hunger: "big",
    alcoholFit: "ì†Œì£¼ êµ­ë£°",
    time: 30,
    difficulty: "ì¤‘",
    description: "ê¸°ë¦„ì§„ ê³ ê¸°ì— ì†Œì£¼ í•œ ì”ì´ë©´ ë§ ë"
  },
  {
    name: "ì œìœ¡ë³¶ìŒ",
    drink: ["soju"],
    hunger: "big",
    alcoholFit: "ë§¤ì½¤í•¨ì´ ì†Œì£¼ë¥¼ ë¶€ë¥¸ë‹¤",
    time: 25,
    difficulty: "ì¤‘",
    description: "ìŠ¤íŠ¸ë ˆìŠ¤ í’€ë¦¬ëŠ” ë§¤ì½¤í•œ ì§‘ìˆ  ì•ˆì£¼"
  },
  {
    name: "íŒŒì „",
    drink: ["soju","beer"],
    hunger: "mid",
    alcoholFit: "ì „ì—” ì—­ì‹œ ì†Œì£¼",
    time: 20,
    difficulty: "ì¤‘",
    description: "ë°”ì‚­í•œ ì „ í•œ ì…ì— ìˆ  í•œ ì”"
  },
  {
    name: "ê³¨ë±…ì´ë¬´ì¹¨",
    drink: ["soju","beer"],
    hunger: "mid",
    alcoholFit: "ìƒˆì½¤ë§¤ì½¤ ì™„ë²½",
    time: 15,
    difficulty: "í•˜",
    description: "ì…ë§› ë‹ìš°ëŠ” í´ë˜ì‹ ì•ˆì£¼"
  },

  // ğŸº ë§¥ì£¼
  {
    name: "ì¹˜í‚¨",
    drink: ["beer"],
    hunger: "big",
    alcoholFit: "ë§¥ì£¼ ì—†ìœ¼ë©´ ì„­ì„­",
    time: 30,
    difficulty: "ì¤‘",
    description: "ë§ì´ í•„ìš” ì—†ëŠ” ë§¥ì£¼ ì•ˆì£¼ì˜ ìµœì¢… ë³´ìŠ¤"
  },
  {
    name: "ê°ìíŠ€ê¹€",
    drink: ["beer"],
    hunger: "light",
    alcoholFit: "ë§¥ì£¼ê°€ ìˆ ìˆ ",
    time: 10,
    difficulty: "í•˜",
    description: "ì§­ì§¤í•¨ìœ¼ë¡œ ë§¥ì£¼ ì†ë„ ì˜¬ë¦¬ëŠ” ì•ˆì£¼"
  },
  {
    name: "ì†Œì‹œì§€ êµ¬ì´",
    drink: ["beer"],
    hunger: "mid",
    alcoholFit: "ë…ì¼ ê°ì„±",
    time: 10,
    difficulty: "í•˜",
    description: "ìœ¡ì¦™ ê°€ë“, ë§¥ì£¼ë‘ ì•ˆì •ì ì¸ ì¡°í•©"
  },
  {
    name: "ì˜¤ì§•ì–´íŠ€ê¹€",
    drink: ["beer"],
    hunger: "mid",
    alcoholFit: "ë°”ì‚­í•¨ ê·¹ëŒ€í™”",
    time: 20,
    difficulty: "ì¤‘",
    description: "íŠ€ê¹€ê³¼ ë§¥ì£¼ì˜ ê³µì‹"
  },
  {
    name: "í”¼ì",
    drink: ["beer"],
    hunger: "big",
    alcoholFit: "íƒ„ì‚°ì´ ëŠë¼í•¨ ì»·",
    time: 25,
    difficulty: "ì¤‘",
    description: "ì—¬ëŸ¿ì´ ë§ˆì‹¤ ë•Œ ì‹¤íŒ¨ ì—†ëŠ” ì„ íƒ"
  },

  // ğŸ· ì™€ì¸ - ê³µí†µ
  {
    name: "ì¹˜ì¦ˆ & ê²¬ê³¼",
    drink: ["wine"],
    wineType: ["red","white"],
    hunger: "light",
    alcoholFit: "ì™€ì¸ ë§›ì„ ì‚´ë ¤ì£¼ëŠ” ì¡°í•©",
    time: 5,
    difficulty: "í•˜",
    description: "ìˆ  ë§›ì„ í•´ì¹˜ì§€ ì•ŠëŠ” ê°€ë²¼ìš´ ì•ˆì£¼"
  },
  {
    name: "ì˜¬ë¦¬ë¸Œ & í–„",
    drink: ["wine"],
    wineType: ["red","white"],
    hunger: "light",
    alcoholFit: "ìœ ëŸ½ì‹ ì •ì„",
    time: 5,
    difficulty: "í•˜",
    description: "ì§ ë§›ìœ¼ë¡œ ì™€ì¸ í’ë¯¸ ê°•ì¡°"
  },

  // ğŸ· ë ˆë“œì™€ì¸
  {
    name: "ìŠ¤í…Œì´í¬",
    drink: ["wine"],
    wineType: ["red"],
    hunger: "big",
    alcoholFit: "ë ˆë“œì™€ì¸ê³¼ í™˜ìƒ ê¶í•©",
    time: 25,
    difficulty: "ì¤‘",
    description: "ìœ¡ì¦™ê³¼ íƒ„ë‹Œì˜ ì •ì„ ì¡°í•©"
  },
  {
    name: "ë²„ì„¯êµ¬ì´",
    drink: ["wine"],
    wineType: ["red"],
    hunger: "mid",
    alcoholFit: "í’ë¯¸ ìƒìŠ¹",
    time: 15,
    difficulty: "í•˜",
    description: "ê³ ê¸° ëŒ€ì²´ìš©ìœ¼ë¡œ ì¢‹ì€ ì•ˆì£¼"
  },
  {
    name: "ë¼êµ¬ íŒŒìŠ¤íƒ€",
    drink: ["wine"],
    wineType: ["red"],
    hunger: "big",
    alcoholFit: "ë¬µì§í•œ ì†ŒìŠ¤ì™€ ì¡°í™”",
    time: 30,
    difficulty: "ì¤‘",
    description: "ì™€ì¸ í•œ ë³‘ ê° ì¡íˆëŠ” ì•ˆì£¼"
  },

  // ğŸ¥‚ í™”ì´íŠ¸ì™€ì¸
  {
    name: "ì—°ì–´ ì¹´ë¥´íŒŒì¹˜ì˜¤",
    drink: ["wine"],
    wineType: ["white"],
    hunger: "mid",
    alcoholFit: "ì‚°ë¯¸ë‘ ì°°ë–¡",
    time: 10,
    difficulty: "í•˜",
    description: "ìƒí¼í•œ ì‚°ë¯¸ë¡œ ì…ì´ ê¹”ë”"
  },
  {
    name: "ìƒˆìš° ìƒëŸ¬ë“œ",
    drink: ["wine"],
    wineType: ["white"],
    hunger: "light",
    alcoholFit: "ê°€ë³ê³  ì‚°ëœ»",
    time: 10,
    difficulty: "í•˜",
    description: "ì—¬ë¦„ ë°¤ì— ì˜ ì–´ìš¸ë¦¬ëŠ” ì•ˆì£¼"
  },
  {
    name: "ê°ë°”ìŠ¤",
    drink: ["wine"],
    wineType: ["white"],
    hunger: "mid",
    alcoholFit: "ë§ˆëŠ˜ í–¥ ê·¹ëŒ€í™”",
    time: 15,
    difficulty: "ì¤‘",
    description: "í™”ì´íŠ¸ì™€ì¸ ëŒ€í‘œ ì•ˆì£¼"
  },

  // ğŸ¥ƒ ìœ„ìŠ¤í‚¤
  {
    name: "ë‹¤í¬ì´ˆì½œë¦¿",
    drink: ["whiskey","wine"],
    hunger: "light",
    alcoholFit: "ìœ„ìŠ¤í‚¤ ë‹¨ë§› ê°•ì¡°",
    time: 3,
    difficulty: "í•˜",
    description: "ì“´ë§›ê³¼ ë‹¨ë§›ì˜ ë°¸ëŸ°ìŠ¤"
  },
  {
    name: "í›ˆì œì˜¤ë¦¬",
    drink: ["whiskey","beer"],
    hunger: "mid",
    alcoholFit: "í›ˆì—°í–¥ê³¼ ê¶í•©",
    time: 10,
    difficulty: "í•˜",
    description: "ìœ„ìŠ¤í‚¤ í–¥ì„ í•´ì¹˜ì§€ ì•ŠëŠ” ì•ˆì£¼"
  },
  {
    name: "ê²¬ê³¼ë¥˜ ë¯¹ìŠ¤",
    drink: ["whiskey"],
    hunger: "light",
    alcoholFit: "í´ë˜ì‹",
    time: 2,
    difficulty: "í•˜",
    description: "ìœ„ìŠ¤í‚¤ ì´ˆë³´ë„ ì‹¤íŒ¨ ì—†ìŒ"
  },
  {
    name: "ì¹˜ì¦ˆ í”Œë˜í„°",
    drink: ["whiskey","wine"],
    hunger: "mid",
    alcoholFit: "í–¥ ìœ ì§€",
    time: 5,
    difficulty: "í•˜",
    description: "ê¸´ ë°¤ì— ì˜ ì–´ìš¸ë¦¬ëŠ” ì¡°í•©"
  }
];

let stepIndex = 0;
const answers = {};
const stepCard = document.getElementById("stepCard");
const resultCard = document.getElementById("resultCard");
let currentRecipe = null;

function random(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

function currentStep() {
  while (
    stepIndex < steps.length &&
    steps[stepIndex].condition &&
    !steps[stepIndex].condition(answers)
  ) {
    stepIndex++;
  }
  return steps[stepIndex];
}

function renderStep() {
  const s = currentStep();
  if (!s) return showResult();

  stepCard.innerHTML = `
    <div class="step-title">${s.q}</div>
    <div class="step-sub">${s.sub}</div>
    <div class="choices">
      ${s.a.map(o =>
        `<div class="choice" onclick="nextStep('${s.key}','${o.v}')">${o.t}</div>`
      ).join("")}
    </div>
  `;
}

function nextStep(key, value) {
  answers[key] = value;
  stepIndex++;
  renderStep();
}

function pickAnju(a) {
  let list = recipes.filter(r =>
    r.drink.includes(a.drink) &&
    (!r.wineType || r.wineType.includes(a.wineType))
  );

  if (!list.length) {
    list = recipes.filter(r => r.drink.includes(a.drink));
  }

  return random(list);
}

function showResult() {
  stepCard.style.display = "none";
  resultCard.style.display = "block";

  currentRecipe = pickAnju(answers);
  renderResultContent(currentRecipe);
}

function reroll() {
  currentRecipe = pickAnju(answers);
  renderResultContent(currentRecipe);
}

function renderResultContent(r) {
  resultCard.innerHTML = `
    <h2>ì˜¤ëŠ˜ì˜ ì•ˆì£¼ ğŸº</h2>
    <p style="font-size:22px;font-weight:800;margin:6px 0">${r.name}</p>
    <p style="color:#94a3b8;font-size:14px">${r.description}</p>

    <div>
      <span class="badge">â± ìˆ  ì•ˆ ì‹ê¸° ì „ì— ${r.time}ë¶„</span>
      <span class="badge">ğŸ”¥ ë‚œì´ë„ ${r.difficulty}</span>
      <span class="badge">ğŸ¶ ${r.alcoholFit}</span>
    </div>

    <div class="actions">
      <button class="btn" onclick="reroll()">ì´ ì•ˆì£¼ ë³„ë¡œë©´ ë‹¤ì‹œ ì¶”ì²œ</button>
      <button class="btn" onclick="saveImage()">ì´ë¯¸ì§€ ì €ì¥ (Threadsìš©)</button>
    </div>
  `;
}

function saveImage() {
  if (!currentRecipe) return;

  const canvas = document.createElement("canvas");
  canvas.width = 1200;
  canvas.height = 630;
  const ctx = canvas.getContext("2d");

  // Background
  ctx.fillStyle = "#020617";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Title
  ctx.fillStyle = "#94a3b8";
  ctx.font = "28px 'Segoe UI', system-ui, sans-serif";
  ctx.fillText("ì§€ê¸ˆ ì´ ìˆ ì—", 60, 80);

  // Recipe name
  ctx.fillStyle = "#ffffff";
  ctx.font = "48px 'Segoe UI', system-ui, sans-serif";
  ctx.fillText(currentRecipe.name, 60, 150);

  // Description
  ctx.fillStyle = "#cbd5e1";
  ctx.font = "22px 'Segoe UI', system-ui, sans-serif";
  const desc = currentRecipe.description;
  wrapText(ctx, desc, 60, 200, 1080, 30);

  // Badges
  const badges = [
    `â± ${currentRecipe.time}ë¶„`,
    `ğŸ”¥ ë‚œì´ë„ ${currentRecipe.difficulty}`,
    `ğŸ¶ ${currentRecipe.alcoholFit}`
  ];
  let x = 60;
  const y = 280;
  badges.forEach(text => {
    const paddingX = 18;
    const paddingY = 10;
    ctx.font = "20px 'Segoe UI', system-ui, sans-serif";
    const w = ctx.measureText(text).width + paddingX * 2;
    const h = 38;
    ctx.fillStyle = "#1e293b";
    ctx.beginPath();
    ctx.roundRect(x, y - h + paddingY, w, h, 16);
    ctx.fill();
    ctx.fillStyle = "#ffffff";
    ctx.fillText(text, x + paddingX, y);
    x += w + 14;
  });

  // Footer
  ctx.fillStyle = "#475569";
  ctx.font = "18px 'Segoe UI', system-ui, sans-serif";
  ctx.fillText("ğŸ» ì§€ê¸ˆ ì´ ìˆ ì— Â· ì•ˆì£¼ ì¶”ì²œ", 60, 360);

  const link = document.createElement("a");
  link.download = `anju-${Date.now()}.png`;
  link.href = canvas.toDataURL("image/png");
  link.click();
}

function wrapText(ctx, text, x, y, maxWidth, lineHeight) {
  const words = text.split(" ");
  let line = "";
  for (let n = 0; n < words.length; n++) {
    const testLine = line + words[n] + " ";
    const metrics = ctx.measureText(testLine);
    if (metrics.width > maxWidth && n > 0) {
      ctx.fillText(line.trim(), x, y);
      line = words[n] + " ";
      y += lineHeight;
    } else {
      line = testLine;
    }
  }
  ctx.fillText(line.trim(), x, y);
}

renderStep();
</script>
</body>
</html>
